- name: Registrar RHELS
  hosts: all
  gather_facts: true
  
  tasks:
  - name: Print some debug information 
    vars: 
      msg: |
        Module Variables ("vars"):
        --------------------------------
        {{ vars | to_nice_json }} 
        
        Environment Variables ("environment"):
        --------------------------------
        {{ environment | to_nice_json }} 

  - debug: 
    msg: "{{ msg.split('\n') }}"       
    tags: debug_info

  - name: Register
    redhat_subscription:
      state: present
      username: '{{ lookup("env", "RHEL_username") }}'
      password: '{{ lookup("env", "RHEL_password") }}'
      pool_ids: '{{ lookup("env", "RHEL_pool") }}'
    when: ansible_facts['os_family'] == "RedHat"
